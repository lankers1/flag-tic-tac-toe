
steps: 
  - name: gcr.io/cloud-builders/docker
    id: build
    entrypoint: 'bash'
    args: ['-c', "docker build --build-arg 'GIT_TAG=$TAG_NAME' --build-arg 'SERVICE_ACCOUNT=$$SERVICE_ACCOUNT' -f client/fttt-build.dockerfile -t gcr.io/$PROJECT_ID/test-james-fe:0.0.1  ."]        
    secretEnv: ["SERVICE_ACCOUNT"]
#   - name: gcr.io/$PROJECT_ID/envsubst
#     id: format-nginx
#     env: ["NGINX_VARIABLE_1=$TAG_NAME"]
#     args: ["nginx.conf"]
#   - name: gcr.io/google.com/cloudsdktool/cloud-sdk
#     id: update-secrets
#     args: ['gcloud', 'secrets', 'versions', 'add', 'my-secret', '--data-file=/workspace/nginx.conf']
availableSecrets:
  secretManager:
  - versionName: projects/$PROJECT_ID/secrets/SERVICE_ACCOUNT/versions/latest
    env: 'SERVICE_ACCOUNT'
substitutions:
  _GCR_HOSTNAME: gcr.io
options:
  logging: CLOUD_LOGGING_ONLY
